# 自动填充工具

一个智能的PC端自动填充工具，当鼠标点击输入框时，如果剪贴板有文字内容，会自动填充到输入框中。

## 功能特点

- 🎯 **智能检测**: 自动检测鼠标点击的输入框
- 📋 **剪贴板监听**: 实时监听剪贴板内容变化
- ⚡ **快速填充**: 使用Ctrl+V快速填充内容
- 🔧 **可配置**: 支持多种配置选项
- 🛡️ **安全可靠**: 避免重复填充，智能排除特定应用
- 🎨 **多种界面**: 命令行、系统托盘、GUI三种使用方式

## 安装依赖

```bash
pip install -r requirements.txt
```

## 使用方法

### 1. 基础版本 (命令行)

```bash
python auto_fill.py
```

**快捷键:**
- `Ctrl+Shift+A`: 切换启用/禁用
- `Ctrl+Shift+S`: 显示状态
- `Ctrl+Shift+Q`: 退出程序

### 2. 高级版本 (系统托盘)

```bash
python auto_fill_advanced.py
```

**功能:**
- 系统托盘图标
- 配置管理
- 应用白名单/黑名单

### 3. GUI版本 (图形界面)

```bash
python auto_fill_gui.py
```

**界面功能:**
- 可视化控制面板
- 实时日志显示
- 参数配置
- 剪贴板测试

## 配置说明

### 基础配置

```json
{
  "enabled": true,
  "click_cooldown": 0.5,
  "max_content_length": 1000,
  "exclude_apps": ["记事本", "notepad", "word", "excel", "powerpoint"],
  "include_apps": [],
  "hotkeys": {
    "toggle": "ctrl+shift+a",
    "status": "ctrl+shift+s",
    "quit": "ctrl+shift+q"
  }
}
```

### 配置参数说明

- `enabled`: 是否启用自动填充功能
- `click_cooldown`: 点击冷却时间（秒），防止重复触发
- `max_content_length`: 最大内容长度限制
- `exclude_apps`: 排除的应用列表（不进行自动填充）
- `include_apps`: 包含的应用列表（仅在这些应用中自动填充）
- `hotkeys`: 快捷键配置

## 工作原理

1. **监听鼠标点击**: 使用keyboard库监听鼠标点击事件
2. **检测输入框**: 通过窗口标题判断是否为输入框
3. **获取剪贴板**: 使用pyperclip获取剪贴板内容
4. **自动填充**: 使用pyautogui模拟Ctrl+V操作

## 安全特性

- **防重复填充**: 避免相同内容重复填充
- **应用过滤**: 智能排除不需要自动填充的应用
- **内容限制**: 限制填充内容的最大长度
- **冷却时间**: 防止频繁触发

## 适用场景

- 网页表单填写
- 聊天软件快速输入
- 文档编辑
- 搜索框快速搜索
- 各种输入框场景

## 注意事项

1. **管理员权限**: 某些应用可能需要管理员权限才能正常工作
2. **安全软件**: 部分安全软件可能会拦截自动操作
3. **应用兼容性**: 某些特殊应用可能不支持自动填充
4. **系统要求**: 支持Windows 10/11系统

## 故障排除

### 常见问题

1. **工具无法启动**
   - 检查Python版本（建议3.7+）
   - 确认所有依赖已正确安装
   - 检查是否有权限问题

2. **自动填充不工作**
   - 确认工具已启动并启用
   - 检查剪贴板是否有内容
   - 确认目标应用不在排除列表中

3. **快捷键冲突**
   - 修改配置文件中的快捷键设置
   - 检查是否有其他软件占用相同快捷键

### 日志文件

工具运行时会生成 `auto_fill.log` 日志文件，可以查看详细的运行信息和错误信息。

## 开发说明

### 项目结构

```
08-自动输入/
├── auto_fill.py              # 基础版本
├── auto_fill_advanced.py     # 高级版本（系统托盘）
├── auto_fill_gui.py          # GUI版本
├── requirements.txt          # 依赖文件
├── README.md                 # 说明文档
├── config.json              # 配置文件（运行时生成）
├── gui_config.json          # GUI配置文件（运行时生成）
└── auto_fill.log            # 日志文件（运行时生成）
```

### 扩展开发

如需添加新功能，可以：

1. 修改 `is_input_field()` 方法改进输入框检测
2. 在配置文件中添加新的配置项
3. 扩展GUI界面添加新的控制选项
4. 添加新的快捷键功能

## 许可证

本项目采用MIT许可证，详见LICENSE文件。

## 贡献

欢迎提交Issue和Pull Request来改进这个工具！

## 更新日志

### v3.0 (GUI版本)
- 添加图形用户界面
- 实时日志显示
- 可视化配置管理
- 剪贴板测试功能

### v2.0 (高级版本)
- 添加系统托盘支持
- 配置文件管理
- 应用白名单/黑名单
- 改进的错误处理

### v1.0 (基础版本)
- 基础自动填充功能
- 快捷键控制
- 简单的日志记录 